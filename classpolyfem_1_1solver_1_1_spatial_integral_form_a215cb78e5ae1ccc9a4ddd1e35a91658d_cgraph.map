<map id="polyfem::solver::SpatialIntegralForm::compute_partial_gradient_unweighted_step" name="polyfem::solver::SpatialIntegralForm::compute_partial_gradient_unweighted_step">
<area shape="rect" id="Node000001" title=" " alt="" coords="5,1506,256,1561"/>
<area shape="rect" id="Node000002" href="$classpolyfem_1_1solver_1_1_adjoint_tools.html#aa650adfcea9ae851fdf1642e5171b29b" title=" " alt="" coords="304,938,543,993"/>
<area shape="poly" id="edge1_Node000001_Node000002" title=" " alt="" coords="144,1505,399,1004,404,1007,148,1507"/>
<area shape="rect" id="Node000043" href="$classpolyfem_1_1solver_1_1_spatial_integral_form.html#ac6f9bf7bd979734dad72425a8a48cc65" title=" " alt="" coords="328,1473,519,1527"/>
<area shape="poly" id="edge48_Node000001_Node000043" title=" " alt="" coords="256,1516,314,1510,315,1515,257,1522"/>
<area shape="rect" id="Node000044" href="$classpolyfem_1_1solver_1_1_diff_cache.html#aa58b56179289dbd2980ff06dfd8b2c0d" title=" " alt="" coords="610,1596,805,1636"/>
<area shape="poly" id="edge49_Node000001_Node000044" title=" " alt="" coords="256,1548,543,1589,597,1597,596,1602,542,1595,256,1554"/>
<area shape="rect" id="Node000045" href="$classpolyfem_1_1solver_1_1_diff_cache.html#aef49f8d41ce8d8665737f8bc381f94c6" title=" " alt="" coords="318,1603,529,1629"/>
<area shape="poly" id="edge50_Node000001_Node000045" title=" " alt="" coords="225,1558,305,1581,362,1597,361,1602,303,1587,223,1563"/>
<area shape="rect" id="Node000003" href="$classpolyfem_1_1utils_1_1_boundary_sampler.html#add6e33ea8fafcdfd2580f0949a7df48d" title=" " alt="" coords="596,133,819,173"/>
<area shape="poly" id="edge2_Node000002_Node000003" title=" " alt="" coords="423,938,432,824,457,653,478,555,507,455,543,357,588,264,624,217,665,180,668,184,628,221,593,267,548,359,512,457,484,557,462,654,437,825,428,938"/>
<area shape="rect" id="Node000008" href="$classpolyfem_1_1assembler_1_1_assembly_vals_cache.html#ae6a71006ed00c05812b65401a1c37d5c" title="retrieves cached basis evaluation and geometric for the given element if it doesn&#39;t exist,..." alt="" coords="627,278,788,333"/>
<area shape="poly" id="edge7_Node000002_Node000008" title=" " alt="" coords="425,937,438,843,466,706,488,630,515,552,548,475,588,404,617,369,651,339,654,343,621,372,593,407,553,478,520,554,493,631,471,708,443,844,430,938"/>
<area shape="rect" id="Node000010" href="$classpolyfem_1_1assembler_1_1_element_assembly_values.html#a736c84178a9391358d50b1d984440538" title="computes the per element values at the local (ref el) points (pts) sets basis_values,..." alt="" coords="612,418,803,473"/>
<area shape="poly" id="edge9_Node000002_Node000010" title=" " alt="" coords="423,937,433,851,443,793,459,730,480,664,508,599,544,538,589,483,598,475,602,479,593,487,548,541,513,601,485,666,464,731,449,794,438,852,429,938"/>
<area shape="rect" id="Node000019" href="$namespacepolyfem_1_1utils.html#ad20302c105652db61d40fbfcb81847ae" title=" " alt="" coords="627,497,788,537"/>
<area shape="poly" id="edge20_Node000002_Node000019" title=" " alt="" coords="425,937,437,860,465,755,486,699,513,644,547,592,589,547,612,532,615,536,592,551,552,596,518,646,491,701,470,757,442,861,430,938"/>
<area shape="rect" id="Node000020" href="$classpolyfem_1_1_integrable_functional.html#a54c5ab6e7a025f2018e96ece8a253121" title=" " alt="" coords="599,561,816,601"/>
<area shape="poly" id="edge21_Node000002_Node000020" title=" " alt="" coords="427,937,443,871,473,783,495,736,521,691,552,648,589,611,595,606,599,611,592,615,556,652,525,693,499,739,478,785,448,872,432,938"/>
<area shape="rect" id="Node000021" href="$classpolyfem_1_1_integrable_functional.html#a466c8fd968a64d639c03ca6a4411873b" title=" " alt="" coords="599,625,816,665"/>
<area shape="poly" id="edge22_Node000002_Node000021" title=" " alt="" coords="430,937,450,881,482,811,528,738,557,704,589,675,597,670,600,674,592,679,561,708,533,741,487,813,455,883,435,938"/>
<area shape="rect" id="Node000022" href="$classpolyfem_1_1_integrable_functional.html#acf54869433421863bf860d9cc13a847b" title=" " alt="" coords="599,689,816,729"/>
<area shape="poly" id="edge23_Node000002_Node000022" title=" " alt="" coords="435,937,458,893,492,840,536,785,589,739,599,733,602,738,592,743,540,789,497,843,463,896,440,939"/>
<area shape="rect" id="Node000023" href="$classpolyfem_1_1_integrable_functional.html#a4b16decdc688dd7396103642f75bb32f" title=" " alt="" coords="599,753,816,793"/>
<area shape="poly" id="edge24_Node000002_Node000023" title=" " alt="" coords="444,936,504,869,545,834,589,803,602,796,605,801,592,808,548,838,508,873,448,940"/>
<area shape="rect" id="Node000025" href="$classpolyfem_1_1_integrable_functional.html#a1b1d9a78cf9cf3f2f23d2ba7b4cf33d1" title=" " alt="" coords="599,817,816,857"/>
<area shape="poly" id="edge26_Node000002_Node000025" title=" " alt="" coords="464,936,522,900,590,867,610,859,612,864,592,872,525,905,467,940"/>
<area shape="rect" id="Node000026" href="$classpolyfem_1_1_integrable_functional.html#af0c6db48d324c19399b8f435c7c76ffc" title=" " alt="" coords="599,881,816,921"/>
<area shape="poly" id="edge28_Node000002_Node000026" title=" " alt="" coords="542,936,604,922,605,927,543,941"/>
<area shape="rect" id="Node000027" href="$classpolyfem_1_1solver_1_1_adjoint_tools.html#a8ef244a2d9d1d64b9ee8c7d876f3b4e1" title=" " alt="" coords="591,945,824,985"/>
<area shape="poly" id="edge30_Node000002_Node000027" title=" " alt="" coords="543,963,577,963,577,968,543,968"/>
<area shape="rect" id="Node000028" href="$classpolyfem_1_1_integrable_functional.html#a2dbc98f95894a044a92f247bedfc4e13" title=" " alt="" coords="599,1009,816,1049"/>
<area shape="poly" id="edge31_Node000002_Node000028" title=" " alt="" coords="543,990,605,1004,604,1009,542,995"/>
<area shape="rect" id="Node000029" href="$classpolyfem_1_1solver_1_1_adjoint_tools.html#a1bd6a5b37bca39571bb8232619a490da" title=" " alt="" coords="593,1073,822,1113"/>
<area shape="poly" id="edge33_Node000002_Node000029" title=" " alt="" coords="467,991,525,1026,592,1059,612,1067,610,1072,590,1064,522,1030,464,995"/>
<area shape="rect" id="Node000030" href="$classpolyfem_1_1_state.html#a106191fffa5a7be86713ae76fb6d5053" title="Get a constant reference to the geometry mapping bases." alt="" coords="626,1137,789,1177"/>
<area shape="poly" id="edge34_Node000002_Node000030" title=" " alt="" coords="448,991,508,1058,548,1093,592,1123,614,1133,612,1138,589,1128,545,1097,504,1061,444,995"/>
<area shape="rect" id="Node000032" href="$namespacepolyfem_1_1utils.html#a7ac07413a97692d41b88a610b9727b9b" title=" " alt="" coords="625,1201,790,1241"/>
<area shape="poly" id="edge36_Node000002_Node000032" title=" " alt="" coords="440,991,463,1035,497,1088,540,1142,592,1187,613,1199,610,1203,589,1192,536,1145,492,1091,458,1037,435,994"/>
<area shape="rect" id="Node000033" href="$classpolyfem_1_1io_1_1_evaluator.html#a37193c8a31244f89fc4586d18101a033" title="interpolate solution and gradient at element (calls interpolate_at_local_vals with sol)" alt="" coords="611,1289,804,1329"/>
<area shape="poly" id="edge37_Node000002_Node000033" title=" " alt="" coords="437,992,458,1045,491,1114,536,1186,563,1221,592,1251,614,1268,637,1281,634,1286,611,1272,589,1255,559,1224,532,1189,487,1116,453,1047,432,994"/>
<area shape="rect" id="Node000036" href="$namespacepolyfem.html#a8d6eb2c01f97c327e382b6dcda332777" title=" " alt="" coords="618,1353,797,1393"/>
<area shape="poly" id="edge41_Node000002_Node000036" title=" " alt="" coords="431,992,446,1062,475,1156,496,1206,523,1255,554,1300,592,1339,607,1350,604,1354,589,1343,550,1303,518,1258,491,1208,470,1158,441,1064,426,993"/>
<area shape="rect" id="Node000038" href="$namespacepolyfem_1_1utils.html#afac51d1fd7878475ff843eef315f510c" title=" " alt="" coords="625,1417,790,1457"/>
<area shape="poly" id="edge43_Node000002_Node000038" title=" " alt="" coords="429,992,440,1073,451,1126,467,1184,488,1244,515,1302,550,1356,592,1403,614,1418,611,1422,589,1407,546,1359,511,1304,483,1246,462,1186,446,1127,435,1074,424,993"/>
<area shape="rect" id="Node000039" href="$classpolyfem_1_1_state.html#a0f244ce7a68b1230a497746a9e4fa5b4" title="quadrature used for projecting boundary conditions" alt="" coords="606,1481,809,1521"/>
<area shape="poly" id="edge44_Node000002_Node000039" title=" " alt="" coords="428,993,435,1084,444,1145,459,1212,480,1281,508,1349,545,1412,593,1467,597,1471,594,1475,589,1471,541,1415,503,1351,474,1283,453,1213,439,1146,430,1084,423,993"/>
<area shape="rect" id="Node000041" href="$namespacepolyfem_1_1utils.html#a75043e8afe913f3bc6279fd5349a4fd4" title=" " alt="" coords="601,1546,813,1571"/>
<area shape="poly" id="edge46_Node000002_Node000041" title=" " alt="" coords="432,992,452,1109,488,1272,510,1355,536,1430,563,1491,593,1532,599,1537,595,1541,589,1535,558,1494,531,1432,505,1356,483,1273,447,1110,426,993"/>
<area shape="rect" id="Node000004" href="$classpolyfem_1_1mesh_1_1_local_boundary.html#a626a35ec8d903d5f0862ee38f53b1508" title="Get the element&#39;s ID." alt="" coords="885,5,1109,45"/>
<area shape="poly" id="edge3_Node000003_Node000004" title=" " alt="" coords="736,131,797,93,871,55,892,47,894,52,873,60,799,97,739,135"/>
<area shape="rect" id="Node000005" href="$classpolyfem_1_1mesh_1_1_local_boundary.html#aa832a6de9bb5d595c5af621c1a7aca88" title="Get the i&#45;th boundary primitive&#39;s global ID." alt="" coords="885,69,1109,109"/>
<area shape="poly" id="edge4_Node000003_Node000005" title=" " alt="" coords="798,131,892,110,893,115,799,136"/>
<area shape="rect" id="Node000006" href="$classpolyfem_1_1mesh_1_1_local_boundary.html#a958c24908487b959468e380dccb42644" title="Number of boundary primitives for the element." alt="" coords="885,133,1109,173"/>
<area shape="poly" id="edge5_Node000003_Node000006" title=" " alt="" coords="819,151,870,151,870,156,819,156"/>
<area shape="rect" id="Node000007" href="$classpolyfem_1_1mesh_1_1_local_boundary.html#aa8a84d69ace838297dcca7bd12e6d34b" title="Get the type of boundary for the element." alt="" coords="885,197,1109,237"/>
<area shape="poly" id="edge6_Node000003_Node000007" title=" " alt="" coords="799,171,893,192,892,197,798,176"/>
<area shape="rect" id="Node000009" href="$classpolyfem_1_1basis_1_1_element_bases.html#a1eb3299faf0fce0b170d524017874af3" title=" " alt="" coords="887,261,1106,301"/>
<area shape="poly" id="edge8_Node000008_Node000009" title=" " alt="" coords="788,296,873,289,874,294,788,301"/>
<area shape="rect" id="Node000011" href="$classpolyfem_1_1basis_1_1_element_bases.html#a6936d345f21ed506227618ef65dba6a6" title="evaluate stored bases at given points on the reference element saves results to basis_values" alt="" coords="887,325,1106,365"/>
<area shape="poly" id="edge10_Node000010_Node000011" title=" " alt="" coords="768,415,871,375,897,367,899,372,873,380,770,420"/>
<area shape="rect" id="Node000013" href="$classpolyfem_1_1basis_1_1_element_bases.html#a731d20029949bd0255c9af1f91dfa74c" title="evaluate gradient of stored bases at given points on the reference element saves results to basis_val..." alt="" coords="887,389,1106,429"/>
<area shape="poly" id="edge12_Node000010_Node000013" title=" " alt="" coords="803,431,873,422,874,427,803,436"/>
<area shape="rect" id="Node000015" href="$classpolyfem_1_1assembler_1_1_element_assembly_values.html#a7ce3e8b5fceffa5bdde29ca3ac79459b" title="void finalize(const Eigen::MatrixXd &amp;v, const Eigen::MatrixXd &amp;dx, const Eigen::MatrixXd &amp;dy); void f..." alt="" coords="901,454,1092,509"/>
<area shape="poly" id="edge14_Node000010_Node000015" title=" " alt="" coords="803,455,888,465,887,470,803,460"/>
<area shape="rect" id="Node000016" href="$classpolyfem_1_1basis_1_1_basis.html#a88b90af0c63d52f2c91fe97a63c540ce" title=" " alt="" coords="1198,527,1359,567"/>
<area shape="poly" id="edge19_Node000010_Node000016" title=" " alt="" coords="798,470,825,483,849,502,859,510,873,518,953,539,1035,550,1114,554,1184,552,1184,558,1114,559,1035,555,952,544,871,522,856,515,846,506,823,488,796,475"/>
<area shape="rect" id="Node000017" href="$classpolyfem_1_1assembler_1_1_element_assembly_values.html#af2830b447f50401acd4e69a57a4b235b" title=" " alt="" coords="901,585,1092,639"/>
<area shape="poly" id="edge16_Node000010_Node000017" title=" " alt="" coords="804,469,826,483,843,504,851,524,858,544,874,563,892,576,889,580,870,567,853,547,846,526,838,506,822,487,801,474"/>
<area shape="rect" id="Node000018" href="$classpolyfem_1_1assembler_1_1_element_assembly_values.html#abfc70df83b8de385510064a839273131" title=" " alt="" coords="901,663,1092,718"/>
<area shape="poly" id="edge18_Node000010_Node000018" title=" " alt="" coords="804,467,826,483,841,505,849,526,850,568,852,609,859,629,874,649,890,662,887,666,870,653,854,631,847,610,845,568,844,527,837,507,822,487,801,471"/>
<area shape="rect" id="Node000012" href="$classpolyfem_1_1basis_1_1_element_bases.html#a9d6e4fd2a6d6491fed600c2a26680d89" title="default to simply calling the Basis evaluation functions" alt="" coords="1169,325,1388,365"/>
<area shape="poly" id="edge11_Node000011_Node000012" title=" " alt="" coords="1106,343,1155,343,1155,348,1106,348"/>
<area shape="rect" id="Node000014" href="$classpolyfem_1_1basis_1_1_element_bases.html#aae3b739e75920739799e866e4b0c448c" title=" " alt="" coords="1169,389,1388,429"/>
<area shape="poly" id="edge13_Node000013_Node000014" title=" " alt="" coords="1106,407,1155,407,1155,412,1106,412"/>
<area shape="poly" id="edge15_Node000015_Node000016" title=" " alt="" coords="1093,501,1186,522,1184,528,1092,506"/>
<area shape="poly" id="edge17_Node000017_Node000016" title=" " alt="" coords="1092,587,1184,566,1186,571,1093,593"/>
<area shape="rect" id="Node000024" href="$classpolyfem_1_1_integrable_functional.html#a171379678cccdd42361b5a2e406d60dc" title=" " alt="" coords="888,849,1105,889"/>
<area shape="poly" id="edge25_Node000023_Node000024" title=" " alt="" coords="785,791,825,803,933,842,931,847,823,808,784,796"/>
<area shape="poly" id="edge27_Node000025_Node000024" title=" " alt="" coords="817,847,875,853,874,858,816,852"/>
<area shape="poly" id="edge29_Node000026_Node000024" title=" " alt="" coords="816,887,874,880,875,885,817,892"/>
<area shape="poly" id="edge32_Node000028_Node000024" title=" " alt="" coords="794,1007,823,995,862,973,900,947,962,897,965,901,903,951,865,977,825,1000,796,1012"/>
<area shape="rect" id="Node000031" href="$classpolyfem_1_1_state.html#ab956f7e3ad92b7ffc1ca1a45ee47903f" title="check if using iso parametric bases" alt="" coords="924,1137,1069,1177"/>
<area shape="poly" id="edge35_Node000030_Node000031" title=" " alt="" coords="789,1155,910,1155,910,1160,789,1160"/>
<area shape="poly" id="edge40_Node000033_Node000033" title=" " alt="" coords="655,1290,652,1280,660,1270,679,1265,707,1263,740,1265,758,1273,756,1278,739,1271,707,1268,680,1270,663,1275,657,1281,660,1288"/>
<area shape="rect" id="Node000034" href="$classpolyfem_1_1mesh_1_1_mesh.html#aadc9bb68805f0a4c0209bee9160c9fc6" title="utily for dimension" alt="" coords="915,1289,1078,1329"/>
<area shape="poly" id="edge38_Node000033_Node000034" title=" " alt="" coords="804,1307,902,1307,902,1312,804,1312"/>
<area shape="rect" id="Node000035" href="$classpolyfem_1_1mesh_1_1_mesh.html#a93c9ea4759ded33a8f25ff157033cfd9" title="checks if mesh is volume" alt="" coords="1197,1289,1360,1329"/>
<area shape="poly" id="edge39_Node000034_Node000035" title=" " alt="" coords="1078,1307,1184,1307,1184,1312,1078,1312"/>
<area shape="rect" id="Node000037" href="$namespacepolyfem.html#a4d64be939c7759c782fff98ed87f3399" title="Retrieves the current logger for adjoint." alt="" coords="908,1361,1085,1386"/>
<area shape="poly" id="edge42_Node000036_Node000037" title=" " alt="" coords="797,1371,894,1371,894,1376,797,1376"/>
<area shape="rect" id="Node000040" href="$classpolyfem_1_1assembler_1_1_assembler_utils.html#a80818109ce6766a1fae1733a0b2e87dc" title="utility for retrieving the needed quadrature order to precisely integrate the given form on the given..." alt="" coords="872,1481,1121,1521"/>
<area shape="poly" id="edge45_Node000039_Node000040" title=" " alt="" coords="809,1499,859,1499,859,1504,809,1504"/>
<area shape="rect" id="Node000042" href="$namespacepolyfem_1_1utils.html#aafdbbff4a81a4fcba11129097b1109e5" title="Unflatten rowwises, so every dim elements in x become a row." alt="" coords="907,1546,1086,1571"/>
<area shape="poly" id="edge47_Node000041_Node000042" title=" " alt="" coords="813,1556,894,1556,894,1561,813,1561"/>
<area shape="poly" id="edge51_Node000045_Node000044" title=" " alt="" coords="529,1613,596,1613,596,1619,529,1619"/>
</map>
